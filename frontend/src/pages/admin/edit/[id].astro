---
import Layout from '../../../layouts/Layout.astro';
import AdminForm from '../../../components/AdminForm.astro';

const { id } = Astro.params;

const API_URL = import.meta.env.INTERNAL_API_URL || import.meta.env.PUBLIC_API_URL;

const response = await fetch(`${API_URL}/reviews/${id}`);

if (!response.ok) {
  return Astro.redirect('/404');
}

const review = await response.json();
---

<Layout title={`Editando: ${review.title}`}>
  <main class="min-h-screen p-8 bg-stone-200">
    <div class="mb-4 flex justify-between items-center max-w-4xl mx-auto">
      <a href={`/review/${review.id}`} class="font-mono text-sm underline hover:text-blue-600">
        &lt; Cancelar e Voltar
      </a>
      <span class="font-mono text-xs bg-yellow-200 px-2 border border-black">MODO ADMIN</span>
    </div>

    <AdminForm isEdit={true} initialData={review} />
  </main>
</Layout>
